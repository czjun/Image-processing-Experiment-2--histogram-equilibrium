# 直方图均衡化实验

## 项目简介
本项目实现了两种图像增强技术：
1. 经典直方图均衡化 (HE)
2. 亮度保持双子直方图均衡化 (BBHE)

## 实验目的
1. 掌握经典直方图均衡 (HE) 的基本原理及实现方法
2. 理解HE的优缺点，分析其在亮度保持上的局限性
3. 学习亮度保持双子直方图均衡 (BBHE) 的改进原理，实现并验证其亮度保持能力
4. 对比HE与BBHE的效果，探讨改进算法的实际应用价值

## 原理简介
### 经典直方图均衡化 (HE)
将图像直方图变换为近似均匀分布，扩展动态范围。通过累积分布函数 (CDF) 进行灰度值映射。

### 亮度保持双子直方图均衡化 (BBHE)
以图像均值为阈值，将图像分割为两个子图像，对子图像分别进行直方图均衡，映射范围约束为 [0, μ] 和 [μ, L-1]。

## 使用方法
1. 确保安装了必要的依赖库：
```bash
pip install opencv-python numpy matplotlib
```

2. 运行程序：
```bash
python histogram_equalization.py
```

3. 程序会生成以下输出：
   - 图像处理结果，包括原图、HE处理结果和BBHE处理结果
   - 各图像的直方图对比
   - 亮度分析数据

4. 输出文件说明：
   - `output/original.png`：原始图像
   - `output/he_result.png`：HE处理结果
   - `output/bbhe_result.png`：BBHE处理结果
   - `output/original_with_hist.png`：原图及其直方图
   - `output/he_with_hist.png`：HE结果及其直方图
   - `output/bbhe_with_hist.png`：BBHE结果及其直方图
   - `output/comparison.png`：三种图像的横向对比
   - `output/histogram_comparison.png`：三种直方图的对比

## 思考题解答

### 1. HE为何会导致图像整体亮度偏移？BBHE如何解决这一问题？
- HE将整个直方图均衡化到整个灰度范围 [0,255]，不考虑原始图像的亮度分布，因此会导致整体亮度偏移。
- BBHE将图像按照均值分为两部分，分别进行均衡化，并限制了各自的映射范围，更好地保持了原始图像的平均亮度。

### 2. 若输入图像的直方图分布极度不均匀（如大部分像素集中在某一段），BBHE是否仍能有效保持亮度？
- BBHE通过分割直方图并分别均衡化，在大多数情况下能比HE更好地保持亮度。
- 但是，如果图像的直方图极度不均匀，BBHE的亮度保持效果可能会受到影响，特别是当大多数像素集中在均值附近时。

### 3. 改进BBHE的方法
- 可以考虑递归平均值分割直方图均衡化 (RMSHE)，将图像反复分割为更多的子图像。
- 也可以尝试采用动态阈值而非简单的均值作为分割点，更好地适应不同图像的特性。
- 对于复杂光照场景，可以考虑先进行自适应区域分割，然后对不同区域应用不同参数的BBHE。 